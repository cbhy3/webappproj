{% extends "base.html" %}

{% block title %}
Tossed Out! - Catalog
{% endblock %}
{% block content %}
    <style>
    .product-card {
    width: 18rem; /* Adjust the width of the card */
    border-radius: 8px;
}
.product-card:hover{
    cursor: pointer;
    transition: 0.3s;
    transform: scale(1.02);
}
.product-image {
    border-radius: 8px 8px 0 0; /* Rounded corners for the image */
    height: 250px; /* Fixed height for consistency */
    object-fit: cover; /* Ensures image scaling */
}

.product-name {
    font-size: 1rem;
    font-weight: 500;
    color: #555;
}

.product-weight {
    font-size: 0.9rem;
    margin-top: -8px;
}

.product-expiry {
    font-size: 0.9rem;
    margin-top: 4px;
}

.card-footer button {
    display: flex;
    align-items: center;
    gap: 4px;
}
body{
    font-family: Garet;
}
    </style>
<body>

      <script>
        document.addEventListener("DOMContentLoaded", function(event) {
            var scrollpos = localStorage.getItem('scrollpos');
            if (scrollpos) window.scrollTo(0, scrollpos);
        });

        window.onbeforeunload = function(e) {
            localStorage.setItem('scrollpos', window.scrollY);
        };

        function performSearch() {
            const input = document.getElementById('input').value.toLowerCase();
            const userCards = document.querySelectorAll('.product-card');

            userCards.forEach(card => {
                const name = card.querySelector('.product-name').textContent.toLowerCase();
                const liElement = card.closest('li');
                if (name.includes(input)) {
                   liElement.classList.remove('d-none');
} else {
    liElement.classList.add('d-none');
}
            });
        }
 function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("open");
    }

    function filterProducts() {
        const checkedCategories = Array.from(document.querySelectorAll('.sidebar input:checked')).map(cb => cb.value);
        console.log(checkedCategories);
        const userCards = document.querySelectorAll('.product-card');

        userCards.forEach(card => {
            const categories = card.dataset.categories;
            console.log(categories)
            const liElement = card.closest('li');
if (checkedCategories.length === 0 || checkedCategories.some(cat => categories.includes(cat))) {
    liElement.classList.remove('d-none');
} else {
    liElement.classList.add('d-none');
}
        });
    }
    </script>
      <style>
          .input-group {
    margin-top: 50px; /* Adjust as needed */
              margin-bottom: 50px;
    width: 25%; /* Adjust the width */

    display: block;
              box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
}

#input {
    width: 100%; /* Ensure input takes full width of .input-group */
}
      </style>
      <style>
    .sidebar {
        position: fixed;
        top: 0;
        right: 0;
        width: 250px;
        z-index: 100;
        height: 100%;
        background: #f8f9fa;
        box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
        padding: 20px;
        transform: translateX(100%);
        transition: transform 0.3s ease-in-out;
    }
    .sidebar.open {
        transform: translateX(0);
    }
    .sidebar h4 {
        margin-bottom: 20px;
    }
    .category-label {
        display: block;
        margin-bottom: 10px;
    }
    .toggle-btn {

        background: #007bff;
        color: white;
        border: none;
        padding: 10px 15px;
        cursor: pointer;
        border-radius: 5px;
    }
.search-container {
    margin-left: 40vw;

  display: flex;
  align-items: center;

    gap:10px;
}

.input-group {
  display: flex;
  align-items: center; /* Ensure the input and button are vertically aligned */
}
.toggle-btn {
  white-space: nowrap; /* Prevent the button text from wrapping */
}
.toggle-btn:hover {
    background-color: #2c4c6f;
    transition: 0.3s ease-in-out;
    transform: scale(1.1);

}
</style>


<div class="sidebar" id="sidebar">
    <h4>Categories</h4>
    <label class="category-label"><input type="checkbox" value="Dairy" onclick="filterProducts()">  Dairy</label>
    <label class="category-label"><input type="checkbox" value="Bakery & Grains" onclick="filterProducts()">  Bakery & Grains</label>
    <label class="category-label"><input type="checkbox" value="Meat & Seafood" onclick="filterProducts()">  Meat & Seafood</label>
    <label class="category-label"><input type="checkbox" value="Pantry and Cooking Essentials" onclick="filterProducts()">  Pantry and Cooking Essentials</label>
    <label class="category-label"><input type="checkbox" value="Snacks & Sweets" onclick="filterProducts()">  Snacks & Sweets</label>
    <label class="category-label"><input type="checkbox" value="Beverages" onclick="filterProducts()">  Beverages</label>
    <label class="category-label"><input type="checkbox" value="Frozen Foods" onclick="filterProducts()">  Frozen Foods</label>
    <label class="category-label"><input type="checkbox" value="Fruits & Vegetables" onclick="filterProducts()">  Fruits & Vegetables</label>
    <label class="category-label"><input type="checkbox" value="Household & Cleaning Supplies" onclick="filterProducts()">  Household & Cleaning Supplies</label>
    <label class="category-label"><input type="checkbox" value="Locally Sourced" onclick="filterProducts()">  Locally Sourced</label>
    <label class="category-label"><input type="checkbox" value="Canned Foods" onclick="filterProducts()">  Canned Foods</label>
</div>

<div class="search-container">
  <div class="input-group">
    <input id="input" type="text" name="q" class="form-control" placeholder="Search for a product..." oninput="performSearch()">
  </div>
  <button class="toggle-btn" onclick="toggleSidebar()">Categories</button>
</div>
<ul class="list-unstyled d-flex flex-wrap justify-content-start">
    {% for product in products %}
        {% if products[product].quantity > 0 %}
        <li class="m-2">
            <div class="card product-card shadow-sm" data-categories="{{ products[product].categories }}">
                <a href="{{ url_for('product_detail', product_id=product) }}" class="text-decoration-none text-dark">
                    <img src="{{ products[product].imageUrl }}" class="card-img-top product-image" alt="{{ products[product].name }}">
                    <div class="card-body">
                        <h5 class="card-title mb-1">${{ products[product].price }}</h5>
                        <p class="card-text product-name">{{ products[product].name }}</p>
                        <p class="text-muted product-weight">{{ products[product].weight }} G</p>
                        <p class="text-danger product-expiry">Expiry Date: <strong>{{ products[product].expiry }}</strong></p>
                    </div>
                </a>
                <div class="card-footer bg-white border-0 d-flex justify-content-between align-items-center">
                    <a class="btn btn-outline-primary btn-sm" href = "{{ url_for('addtocart', product_id=product) }}">
                         Add to Cart
                    </a>
                    <button class="btn btn-outline-danger btn-sm">
                        <span style = "text-align: center; color: red">&#9829;</span>
                    </button>
                </div>
            </div>
        </li>
        {% endif %}
    {% endfor %}
</ul>

</body>

{% endblock %}